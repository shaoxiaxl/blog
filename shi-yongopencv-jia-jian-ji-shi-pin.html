<!DOCTYPE html><html lang="zh-cn"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>使用opencv夹剪辑视频 - 少侠的记事本</title><meta name="description" content="opencv介绍安装opencv2支持python2.x版本 因为opencv依赖numpy所以我们要先安装numpy 安装完成后，打开IDE确保安装成功 C:\libpython&gt;python.exePython 2.7.13 (v2.7.13:a06454b1afa1, Dec 17 2016, 20:53:40) [MSC v.1500 64 bit (AMD64)] on win32Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.&gt;&gt;&gt; import numpy&gt;&gt;&gt;下载OpenCV安装包，安装后解压 打开解压目录 opencv/build/python/2.7 复制cv2.pyd 到你python的Python27/lib/site-packeges目录下 打开IDE确保安装正常 &gt;&gt;&gt; print cv2.__version__&#39;2.4.13.3&#39;官方教程 按照他官方的教程到这一步导入cv2包没有问题，就算安装成功了。但是在实际使用中打开视频文件的时候总是失败，网上搜同样的问题一大把，不清楚到底是bug，还是电脑环境问题（怀疑的问题系统环境变量path）。 stackoverflow上讨论和解决方法 我的解决方法是把 J:\opencv\opencv\sources\3rdparty\ffmpeg目录下的opencv_ffmpeg_64.dll文件复制到我python目录下并改名为opencv_ffmpeg{opencv版本号}_64.dll我的是opencv_ffmpeg2413_64.dll 使用打开一个视频文件#打开视频文件 cap = cv2.VideoCapture(in_path) if False&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://shaoxiaxl.github.io/blog/shi-yongopencv-jia-jian-ji-shi-pin.html"><link rel="amphtml" href="https://shaoxiaxl.github.io/blog/amp/shi-yongopencv-jia-jian-ji-shi-pin.html"><link rel="alternate" type="application/atom+xml" href="https://shaoxiaxl.github.io/blog/feed.xml"><link rel="alternate" type="application/json" href="https://shaoxiaxl.github.io/blog/feed.json"><meta property="og:title" content="使用opencv夹剪辑视频"><meta property="og:site_name" content="少侠的记事本"><meta property="og:description" content="opencv介绍安装opencv2支持python2.x版本 因为opencv依赖numpy所以我们要先安装numpy 安装完成后，打开IDE确保安装成功 C:\libpython&gt;python.exePython 2.7.13 (v2.7.13:a06454b1afa1, Dec 17 2016, 20:53:40) [MSC v.1500 64 bit (AMD64)] on win32Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.&gt;&gt;&gt; import numpy&gt;&gt;&gt;下载OpenCV安装包，安装后解压 打开解压目录 opencv/build/python/2.7 复制cv2.pyd 到你python的Python27/lib/site-packeges目录下 打开IDE确保安装正常 &gt;&gt;&gt; print cv2.__version__&#39;2.4.13.3&#39;官方教程 按照他官方的教程到这一步导入cv2包没有问题，就算安装成功了。但是在实际使用中打开视频文件的时候总是失败，网上搜同样的问题一大把，不清楚到底是bug，还是电脑环境问题（怀疑的问题系统环境变量path）。 stackoverflow上讨论和解决方法 我的解决方法是把 J:\opencv\opencv\sources\3rdparty\ffmpeg目录下的opencv_ffmpeg_64.dll文件复制到我python目录下并改名为opencv_ffmpeg{opencv版本号}_64.dll我的是opencv_ffmpeg2413_64.dll 使用打开一个视频文件#打开视频文件 cap = cv2.VideoCapture(in_path) if False&hellip;"><meta property="og:url" content="https://shaoxiaxl.github.io/blog/shi-yongopencv-jia-jian-ji-shi-pin.html"><meta property="og:type" content="article"><style>:root{--body-font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";--heading-font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";--logo-font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";--menu-font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol"}</style><link rel="stylesheet" href="https://shaoxiaxl.github.io/blog/assets/css/style.css?v=1d9126d5c592483966037cf187b30969"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://shaoxiaxl.github.io/blog/shi-yongopencv-jia-jian-ji-shi-pin.html"},"headline":"使用opencv夹剪辑视频","datePublished":"2017-08-17T21:02","dateModified":"2020-11-20T23:25","description":"opencv介绍安装opencv2支持python2.x版本 因为opencv依赖numpy所以我们要先安装numpy 安装完成后，打开IDE确保安装成功 C:\\libpython&gt;python.exePython 2.7.13 (v2.7.13:a06454b1afa1, Dec 17 2016, 20:53:40) [MSC v.1500 64 bit (AMD64)] on win32Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.&gt;&gt;&gt; import numpy&gt;&gt;&gt;下载OpenCV安装包，安装后解压 打开解压目录 opencv/build/python/2.7 复制cv2.pyd 到你python的Python27/lib/site-packeges目录下 打开IDE确保安装正常 &gt;&gt;&gt; print cv2.__version__&#39;2.4.13.3&#39;官方教程 按照他官方的教程到这一步导入cv2包没有问题，就算安装成功了。但是在实际使用中打开视频文件的时候总是失败，网上搜同样的问题一大把，不清楚到底是bug，还是电脑环境问题（怀疑的问题系统环境变量path）。 stackoverflow上讨论和解决方法 我的解决方法是把 J:\\opencv\\opencv\\sources\\3rdparty\\ffmpeg目录下的opencv_ffmpeg_64.dll文件复制到我python目录下并改名为opencv_ffmpeg{opencv版本号}_64.dll我的是opencv_ffmpeg2413_64.dll 使用打开一个视频文件#打开视频文件 cap = cv2.VideoCapture(in_path) if False&hellip;","author":{"@type":"Person","name":"ShaoXia"},"publisher":{"@type":"Organization","name":"ShaoXia"}}</script></head><body><div class="site-container"><header class="top" id="js-header"><a class="logo" href="https://shaoxiaxl.github.io/blog/">少侠的记事本</a></header><main><article class="post"><div class="hero"><header class="hero__content"><div class="wrapper"><div class="post__meta"><time datetime="2017-08-17T21:02">八月 17, 2017</time></div><h1>使用opencv夹剪辑视频</h1><div class="post__meta post__meta--author"><a href="https://shaoxiaxl.github.io/blog/authors/shaoxia/" class="feed__author invert">ShaoXia</a></div></div></header></div><div class="wrapper post__entry"><h3 id="opencv介绍">opencv介绍</h3><h4 id="安装">安装</h4><p>opencv2支持python2.x版本</p><ol><li><p>因为opencv依赖numpy所以我们要先安装numpy</p><ul><li>可以这样安装sudo pip install numpy</li><li>或者下载安装包安装 numpy下载</li></ul></li><li><p>安装完成后，打开IDE确保安装成功</p><pre><code>C:\libpython&gt;python.exe
Python 2.7.13 (v2.7.13:a06454b1afa1, Dec 17 2016, 20:53:40) [MSC v.1500 64 bit (AMD64)] on win32
Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
&gt;&gt;&gt; import numpy
&gt;&gt;&gt;</code></pre></li><li><p>下载OpenCV安装包，安装后解压</p></li><li><p>打开解压目录 opencv/build/python/2.7</p></li><li><p>复制cv2.pyd 到你python的Python27/lib/site-packeges目录下</p></li><li><p>打开IDE确保安装正常</p><pre><code class="language-&gt;&gt;&gt;">&gt;&gt;&gt; print cv2.__version__
&#39;2.4.13.3&#39;</code></pre><p><a href="https://opencv-python-tutroals.readthedocs.io/en/latest/py_tutorials/py_setup/py_setup_in_windows/py_setup_in_windows.html#install-opencv-python-in-windows">官方教程</a></p></li></ol><p>按照他官方的教程到这一步导入cv2包没有问题，就算安装成功了。但是在实际使用中打开视频文件的时候总是失败，网上搜同样的问题一大把，不清楚到底是bug，还是电脑环境问题（怀疑的问题系统环境变量path）。</p><p><a href="https://stackoverflow.com/questions/11699298/opencv-2-4-videocapture-not-working-on-windows">stackoverflow上讨论和解决方法</a></p><p>我的解决方法是把 <code>J:\opencv\opencv\sources\3rdparty\ffmpeg</code>目录下的<code>opencv_ffmpeg_64.dll</code>文件复制到我python目录下并改名为<code>opencv_ffmpeg{opencv版本号}_64.dll</code>我的是<code>opencv_ffmpeg2413_64.dll</code></p><p>使用 打开一个视频文件 #打开视频文件</p><pre><code>cap = cv2.VideoCapture(in_path)   
if False == cap.isOpened():  #判断打开是否成功
    print(&quot;error&quot;)
else:
    print(&quot;ok&quot;)</code></pre><p>读取视频 获取解码并返回视频下一帧，失败返回false。 <code>ret, frame = cap.read()</code> 获取视频属性 可以用cap.get(propId)方法获得视频的属性，propId的范围为0-18，每个数代表视频的一个属性，官方说明看这里VideoCapture::get。</p><p>常用参数</p><ul><li>propId | 属性</li><li>0 | 当前文件位置时间</li><li>1 |下一帧</li><li>3 | 宽度</li><li>4| 高度</li><li>5 | 帧速</li><li>6 | 视频编码格式</li><li>7 | 文件总帧数 还有一种方法来获取视频参数</li></ul><p>帧速 <code>fps = cap.get(cv2.cv.CV_CAP_PROP_FPS)</code> #宽高<br><code>size = (int(cap.get(cv2.cv.CV_CAP_PROP_FRAME_WIDTH)), int(cap.get(cv2.cv.CV_CAP_PROP_FRAME_HEIGHT)))</code> 设置视频属性 可以用<code>cap.set(propId, value)</code>方法设置视频的属性<code>VideoCapture::set</code></p><ul><li><p>propId | 属性</p></li><li><p>0 | 视频文件的当前位置，以毫秒为单位。</p></li><li><p>1 | 下一帧解码/捕获帧的索引</p></li><li><p>2 | 视频文件的相对位置：0 - 开始，1 - 结束。</p></li><li><p>3 | 视频流的宽度</p></li><li><p>4 | 视频流的高度</p></li><li><p>5 | 帧速</p></li><li><p>6 | 编解码器的4个字符代码。</p></li><li><p>7 | 视频文件中的帧数 使用opencv剪辑视频</p><pre><code>def cut_video(in_path, out_path, start, end):
  cap = cv2.VideoCapture(in_path)
  fps = cap.get(cv2.cv.CV_CAP_PROP_FPS)
  size = (int(cap.get(cv2.cv.CV_CAP_PROP_FRAME_WIDTH)),   
          int(cap.get(cv2.cv.CV_CAP_PROP_FRAME_HEIGHT)))
  fourcc = cv2.cv.CV_FOURCC(*&#39;XVID&#39;)
  out = cv2.VideoWriter(out_path, fourcc, fps, size)

  for index in range(start,end):
      cap.set(1, index)
      ret, frame = cap.read()
      cv2.waitKey(1000/int(fps))
      cv2.imshow(&quot;video&quot;, frame)#边查看
      out.write(frame)
  cap.release() #释放
  out.release()</code></pre></li></ul></div><footer class="wrapper post__footer"><p class="post__last-updated">This article was updated on 十一月 20, 2020</p><div class="post__share"></div><div class="post__bio bio"><div class="bio__info"><h3 class="bio__name"><a href="https://shaoxiaxl.github.io/blog/authors/shaoxia/" class="invert" rel="author">ShaoXia</a></h3></div></div></footer></article><nav class="post__nav"><div class="post__nav-inner"><div class="post__nav-prev"><svg width="1.041em" height="0.416em" aria-hidden="true"><use xlink:href="https://shaoxiaxl.github.io/blog/assets/svg/svg-map.svg#arrow-prev"/></svg> <a href="https://shaoxiaxl.github.io/blog/config-wen-jian-de-you-ya-xie-fa.html" class="invert post__nav-link" rel="prev"><span>Previous</span> config文件的优雅写法</a></div><div class="post__nav-next"><a href="https://shaoxiaxl.github.io/blog/python-zhuang-shi-qi.html" class="invert post__nav-link" rel="next"><span>Next</span> python装饰器 </a><svg width="1.041em" height="0.416em" aria-hidden="true"><use xlink:href="https://shaoxiaxl.github.io/blog/assets/svg/svg-map.svg#arrow-next"/></svg></div></div></nav></main><footer class="footer"><div class="footer__copyright"><p>Powered by <a href="https://getpublii.com" target="_blank" rel="nofollow noopener">Publii</a></p></div><button class="footer__bttop js-footer__bttop" aria-label="Back to top"><svg><title>Back to top</title><use xlink:href="https://shaoxiaxl.github.io/blog/assets/svg/svg-map.svg#toparrow"/></svg></button></footer></div><script>window.publiiThemeMenuConfig = {    
        mobileMenuMode: 'sidebar',
        animationSpeed: 300,
        submenuWidth: 'auto',
        doubleClickTime: 500,
        mobileMenuExpandableSubmenus: true, 
        relatedContainerForOverlayMenuSelector: '.top',
   };</script><script defer="defer" src="https://shaoxiaxl.github.io/blog/assets/js/scripts.min.js?v=f4c4d35432d0e17d212f2fae4e0f8247"></script><script>var images = document.querySelectorAll('img[loading]');

        for (var i = 0; i < images.length; i++) {
            if (images[i].complete) {
                images[i].classList.add('is-loaded');
            } else {
                images[i].addEventListener('load', function () {
                    this.classList.add('is-loaded');
                }, false);
            }
        }</script></body></html>